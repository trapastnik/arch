<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–ª–∞–Ω—à–µ—Ç–æ–≤ ‚Äî ONNX Web v auto roi</title>
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
  <!-- OpenCV.js –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∏ warp -->
  <script async src="https://docs.opencv.org/4.x/opencv.js"></script>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="wrap">
    <h1>üì∑ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–ª–∞–Ω—à–µ—Ç–æ–≤ (ONNXRuntime Web)</h1>

    <div class="card">
      <div class="video-wrap">
        <video id="video" playsinline muted></video>
        <canvas id="overlay"></canvas>
      </div>

      <div class="controls">
        <button id="btnStart">–°—Ç–∞—Ä—Ç –∫–∞–º–µ—Ä—ã</button>
        <button id="btnStop" disabled>–°—Ç–æ–ø</button>
        <button id="btnFlip">–ü–æ–º–µ–Ω—è—Ç—å –∫–∞–º–µ—Ä—É</button>
      </div>

      <div class="settings">
        <div class="row">
          <label>–ö–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ:</label>
          <select id="selCrop">
            <option value="full">Full frame (resize)</option>
            <option value="center">Center-crop (square)</option>
            <option value="auto" selected>Auto-ROI (–¥–µ—Ç–µ–∫—Ç–æ—Ä)</option>
          </select>
        </div>
        <div class="row">
          <label>–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:</label>
          <select id="selNorm">
            <option value="neg1to1" selected>[-1, 1]</option>
            <option value="zero1">[0, 1]</option>
            <option value="imagenet">ImageNet mean/std</option>
          </select>
        </div>
        <div class="row">
          <label>ROI pad: <span id="valPad">0.08</span></label>
          <input id="rngPad" type="range" min="0" max="0.30" step="0.01" value="0.08" />
        </div>
        <div class="row">
          <label>EMA: <span id="valEma">0.35</span></label>
          <input id="rngEma" type="range" min="0" max="0.95" step="0.01" value="0.35" />
        </div>
      </div>

      <div id="result">–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É‚Ä¶</div>
      <div id="sub" class="muted">–ó–∞–≥—Ä—É–∑–∏—Ç—Å—è –º–æ–¥–µ–ª—å –∏ –∫–∞—Ä—Ç–∞ –∫–ª–∞—Å—Å–æ–≤.</div>
      <div id="progressWrap"><div id="progress"></div></div>
      <div class="topk-row"><span class="label">–¢–æ–ø-3:</span><span id="topk"></span></div>

      <details>
        <summary>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</summary>
        <pre id="diag"></pre>
      </details>

      <div class="footer">
        –ù—É–∂–µ–Ω HTTPS (GitHub Pages –ø–æ–¥–æ–π–¥—ë—Ç). –ù–∞ iOS –∫–∞–º–µ—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞.
      </div>
    </div>
  </div>

  <script type="module" src="./src/main.js"></script>
  
  <!-- –ù–∞—à –ª—ë–≥–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω Auto-ROI -->
  <script src="src/pipeline-auto-roi.js"></script>
</body>
</html>